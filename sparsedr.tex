%%%% ijcai26.tex

\typeout{IJCAI--ECAI 26 Instructions for Authors}

% These are the instructions for authors for IJCAI--ECAI 26.

\documentclass{article}
\pdfpagewidth=8.5in
\pdfpageheight=11in

% The file ijcai26.sty is a copy from ijcai22.sty
% The file ijcai22.sty is NOT the same as previous years'
\usepackage{ijcai26}

% Use the postscript times font!
\usepackage{times}
\usepackage{soul}
\usepackage{url}
\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[small]{caption}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[switch]{lineno}

% Comment out this line in the camera-ready submission
\linenumbers

\urlstyle{same}

% the following package is optional:
%\usepackage{latexsym}

% See https://www.overleaf.com/learn/latex/theorems_and_proofs
% for a nice explanation of how to define new theorems, but keep
% in mind that the amsthm package is already included in this
% template and that you must *not* alter the styling.
\newtheorem{example}{Example}
\newtheorem{theorem}{Theorem}

% Following comment is from ijcai97-submit.tex:
% The preparation of these files was supported by Schlumberger Palo Alto
% Research, AT\&T Bell Laboratories, and Morgan Kaufmann Publishers.
% Shirley Jowell, of Morgan Kaufmann Publishers, and Peter F.
% Patel-Schneider, of AT\&T Bell Laboratories collaborated on their
% preparation.

% These instructions can be modified and used in other conferences as long
% as credit to the authors and supporting agencies is retained, this notice
% is not changed, and further modification or reuse is not restricted.
% Neither Shirley Jowell nor Peter F. Patel-Schneider can be listed as
% contacts for providing assistance without their prior permission.

% To use for other conferences, change references to files and the
% conference appropriate and use other authors, contacts, publishers, and
% organizations.
% Also change the deadline and address for returning papers and the length and
% page charge instructions.
% Put where the files are available in the appropriate places.


% PDF Info Is REQUIRED.

% Please leave this \pdfinfo block untouched both for the submission and
% Camera Ready Copy. Do not include Title and Author information in the pdfinfo section
\pdfinfo{
/TemplateVersion (IJCAI.2026.0)
}

\title{Differentiable Rendering of Sparse SDFs}

% Single author syntax
% \author{
%     Author Name
%     \affiliations
%     Affiliation
%     \emails
%     email@example.com
% }

% Multiple author syntax (remove the single-author syntax above and the \iffalse ... \fi here)
% \iffalse
\author{
First Author$^1$
\and
Second Author$^2$\and
Third Author$^{2,3}$\And
Fourth Author$^4$\\
\affiliations
$^1$First Affiliation\\
$^2$Second Affiliation\\
$^3$Third Affiliation\\
$^4$Fourth Affiliation\\
\emails % usually included
\{first, second\}@example.com,
third@other.example.com,
fourth@example.com
}
% \fi

\begin{document}

\maketitle

\begin{abstract}
    % За последнее десятилетие задача 3D реконструкции получила новый способ решения:
    % дифференцируемый рендеринг -- мощный инструмент, в рамках которого было предложено большое разнообразие
    % методов. Одна группа методов направлена на восстановление объектов, представленных
    % signed distance field grids, в рамках физически-обоснованного рендеринга. Signed
    % distance fields хорошо подходят для реконструкции поверхности, but the use of the dense grids leads to
    % быстрый рост потребляемой памяти при восстановлении моделей
    % with fine details. В этой работе предлагается метод дифференцируемого рендеринга для
    % sparse representations based on signed distance field. Благодаря этому мы получаем существенное
    % сокращение используемой памяти без потерь в точности и скорости реконструкции, что демонстрируем
    % на примерах реконструкции геометрии.

    3D reconstruction has achieved notable development over the past decade with the emergence of differentiable rendering -- a powerful tool that has spawned a wide variety of methods. One group of methods is aimed at reconstructing objects represented by SDF grids within the framework of physically-based rendering. A major drawback of such an approach is the rapid growth of memory consumption when reconstructing models with fine details. In this work, we propose an adaptation of the differentiable rendering method for SDF to a sparse representation, with sparse versions of redistancing and regularization. Through this, we achieve a reduction in memory usage and more accurate reconstruction of object geometry.
\end{abstract}

\section{Introduction}
    3D object reconstruction as (something else and then) Inverse rendering.
    % Задача трёхмерной реконструкции -- получение информации об объекте реального
    % мира, в частности его форме. (TODO: про 3д реконструкцию + подводка к обратному рендерингу)

    % В рамках компьютерного зрения и графики ещё в конце XX века [ссылка] была сформулирована
    % задача обратного рендеринга. Если традиционный, прямой рендеринг позволяет получить
    % 2D изображение из 3D сцены, то обратный рендеринг подразумевает восстановление
    % параметров исходной сцены по её изображениям. Таким образом, задача обратного рендеринга
    % включает в себя трёхмерную реконструкцию.

    Inverse rendering to Differentiable rendering.
    % В последнее десятилетие для решения задачи обратного рендеринга активно
    % используется дифференцируемый рендеринг -- метод, восстанавливающий объекты
    % по изображениям с использованием градиентных методов оптимизации. Существует
    % большое число разнообразных методов дифференцируемого рендеринга. Между собой
    % они различаются, в первую очередь, тем, какое представление используется в процессе
    % оптимизации: нейронные SDF [NeuralAngelo+], NeRF [ссылки], 3DGS [ссылки] (TODO: ещё что-нибудь).

    DR methods for physically-based rendering. Tell a bit about meshes and Nicolet article, then about two nonNN methods (2022,2024).
    % В 2018 году появился метод edge sampling [ссылка], впервые позволивший получить
    % аналитические производные по параметрам геометрии, в частности меша, в физически-обоснованном
    % рендеринге. В этих условиях цвет пикселя представляет собой интеграл. При дифференцировании
    % по параметрам, задающим форму объекта, подынтегральное выражение терпит разрывы,
    % положение которых зависит от этих параметров. Для корректного расчёта градиентов
    % требуется оценить интеграл по этим разрывам, названный граничным интегралом. В edge
    % sampling предлагалось явно семплировать граничный интеграл, что требовало нахождения
    % всех граней, образующих силуэт объекта. В 2019
    % и 2020 годах появились два связанных между собой метода, которые избавлялись от
    % необходимости явного семплирования границ объекта при оценке производных. Первый
    % подход, репараметризация [ссылка], предлагал замену переменных, которая локально
    % учитывала разрывы, что позволяло уйти от оценки граничного интеграла вовсе. Метод
    % 2020 года, warped area sampling (WAS) [ссылка], строго показал, что граничный
    % интеграл в формуле производной возникает согласно транспортной теореме Рейнольдса,
    % и предложил продлить область определения граничного интеграла на пространство с
    % помощью теоремы Остроградского-Гаусса. Для этого перехода строится специальное 
    % векторное поле.

    % Три подхода к дифференцируемому рендерингу, описанные выше, использовали меши в практической 
    % реализации. Однако, меши, с точки зрения задачи реконструкции поверхности, имеют ряд фундаментальных 
    % проблем, которые делают их использование нежелательным. Их недостатки хорошо описаны и 
    % проиллюстрированы в работе 2021 года [ссылка]. Фундаментальной проблемой мешей является 
    % невозможность менять топологию объекта (род поверхности), также во время оптимизации могут возникать 
    % необратимые самопересечения и неоптимальные распределения примитивов, из-за чего в местах, требующих 
    % высокой детализации, нет достаточного числа примитивов для их представления. Модификации, 
    % представленные в работе, частично решают две последние проблемы, но
    % ограничение на топологию мешает свободному применению мешей для оптимизации.

    % Следом появилось несколько методов, также применимых в физически-обоснованном
    % рендеринге, которые использовали SDF grids в качестве оптимизируемого представления.
    % В 2022 году к SDF впервые применили репараметризацию [ссылка]. В этой работе было
    % предложено использовать алгоритм редистансинга. Редистансинг – задача пересчёта
    % значений сетки, чтобы её вершины содержали корректные расстояния до поверхности. В
    % дифференцируемом рендеринге пересчёт нужен, поскольку после шага оптимизации и 
    % обновления расстояний в узлах сетки она, строго говоря, уже не является SDF. Наконец,
    % метод 2024 года [ссылка] использует свойства функций расстояния и
    % оценивает граничный интеграл интегралом по релаксированной границе – тонкой линии
    % вокруг силуэта объекта.

    % При использовании SDF grid повышение детализации модели для более точной реконструкции поверхности
    % достигается путём апсемплинга всей сетки, что приводит к быстрому росту размера модели.
    % При этом для представления самой поверхности используется лишь небольшая часть вокселей,
    % и потребление памяти можно существенно снизить, если хранить только их. Статья [ссылка]
    % описывает несколько вариантов основанных на SDF разреженных представлений, в частности sparse brick set.
    % Данное представление представляет собой a sparse set of bricks -- small non-intersecting SDF grids.
    % Каждый такой кирпич хранится в листовом узле дерева BVH. Также в статье предлагаются
    % новые алгоритмы для пересечения луча с вокселем: метод Ньютона и аналитический метод.
    % Оба основаны на факте, что внутри вокселя, в случае трилинейной интерполяции, функция
    % расстояния вдоль луча представима кубическим полиномом. Отличие между ними заключается в
    % поиске корней этого полинома: аналитическом расчёте или же нескольких шагах метода Ньютона.

    This method combines the idea of a relaxed boundary with the sparse SDF representation
    from [link].
    % В данной работе представлен метод дифференцируемого рендеринга SDF, сочетающий идею оценки
    % граничного интеграла из [ссылка] с SBS. Для
    % пересечения луча со сценой используется метод Ньютона, адаптированный
    % под поиск точек релаксированной границы. Реализованы две версии редистансинга: разреженная
    % версия fast sweeping метода и приближённая ускоренная версия, а также разреженные версии
    % остальных этапов алгоритма. Добавлен sparsification step, отвечающий за удаление и
    % добавление of bricks. В результате получен алгоритм, способный восстанавливать модели со
    % скоростью и точностью not inferior to the baseline method при существенном сокращении потребляемой памяти.

\section{System Architecture}
    Describe architecture -- components (their algorithms).
    % TODO: привести два алгоритма. Первый (внешний) показывает итерации по пресетам, между
    % которыми происходит разрежение и апсемплинг. Второй (внутренний) вызывается внутри
    % первого и содержит итерации дифф рендеринга. ПОСЛЕ попробовать показать, какие его
    % шаги новые, какие претерпели изменения, а какие остались нетронутыми.

    % Core differentiable rendering algorithm представляет собой
    % метод обучения с учителем, в котором на каждой итерации происходит отрисовка сцены с
    % ракурса, соответствующего одному из референсных изображений, после чего считается
    % функция потерь (MSE) между двумя рендерами и backpropagates к параметрам сцены.
    % Для корректного расчёта производных по дистанциям, следуя транспортной теореме Рейнольдса,
    % оценивается внутренний и граничный интеграл. Для оценки последнего был реализован метод
    % релаксированной границы из работы (ссылка), которая также является для нас базовой.
    % Мы также применяем Laplace filter и редистансинг для более стабильной реконструкции.

    % Однако замена представления повлекла за собой модификацию всего алгоритма. На рис. таком-то (псевдокодом)
    % показан алгоритм предлагаемого метода. В начале процесса оптимизации
    % SBS хранит все брики, составляя грид размером 32x32x32 voxels, так как на этом этапе the grid itself небольшой,
    % а поверхность объекта претерпевает наибольшие изменения. Затем, during the sparsification step сохраняются только
    % брики, которые содержат поверхность, и их ближайшие соседи.

\subsection{Calculation of Derivatives}

    % Ключевым отличием предлагаемого метода является переход от SDF grid к
    % sparse brick set. В нашем случае, размер каждого брика фиксирован
    % и равен 4x4x4 voxels. Для SBS строится BVH tree, каждый листовой узел которого хранит один brick.
    % Помимо sphere tracing [link], были реализованы альтернативные методы
    % of ray-SDF intersection [link]: Newton and analytic, специально созданные для
    % поиска пересечения inside the voxel. Теперь луч traverses the BVH first, и, если найдено
    % пересечение с листовым узлом, intersects the voxels of the brick. Луч проходит каждый
    % брик на своём пути, до первого пересечения с поверхностью.

    % Alternative ray-SDF intersection methods also support поиск точек релаксированной
    % границы. Из [ссылка], точка принадлежит релаксированной границе, если SDF в этой
    % точке меньше некоторого порога, названного relaxed epsilon, а производная SDF along
    % the ray reaches its local minimum.
    % Newton and analytic methods are based on the fact that inside the voxel, SDF along
    % the ray представима в виде полинома третьей степени. Таким образом, внутри вокселя
    % потенциальная точка релаксированной границы может быть найдена как корень квадратного уравнения,
    % после чего нужно лишь проверить, что значение SDF в ней меньше relaxed epsilon. Случай,
    % когда локальный минимум достигается на границе вокселей или бриков, обрабатывается отдельно.

    % В реализации метода используется дополнительный шейдер, который семплирует только
    % пиксели, содержащие границы, и оценивает только граничный интеграл. Это явное
    % семплирование границы позволяет получить более точные градиенты для меньшего
    % relaxed epsilon, снижая bias.

\subsection{Redistancing}

    % Редистансинг, используемый в нашем методе, основан на fast sweeping method [link]
    % и модифицирован для поддержки SBS. Важным отличием этого представления является
    % случай, когда в одном брике не могут быть учтены дистанции из другого брика, потому
    % что между ними нет промежуточных бриков. Крайний случай -- когда брик не содержит
    % поверхность и у него нет ни одного соседа, тогда его значения не будут пересчитаны
    % вовсе. Чтобы учесть такую возможность, в алгоритм был добавлен поиск соседних
    % граней и шаг экстраполяции.

    % TODO: рисунок, показывающий в 2D случае, какие грани соседних бриков будут использоваться
    % на шаге экстраполяции.

    % Переписываем хрень выше так: сначала рассказ о том, что для реализации редистансинга
    % для разреженного представления есть две проблемы: поиск соседей и связь между разрозненными
    % частями сетки.
    % Сперва был реализован честный разреженный редистансинг на основе фаст свип. В нём
    % используется массив с информацией обо всех соседях для каждой дистанции, а также поиск соседей
    % для бриков и экстраполяция значений для граней брика, к которым не прилегают соседи.
    % Он неэффективен, но его цель: быть baseline для ускоренной версии.

    % Ускоренная версия обновляет дистанции только в бриках, содержащих поверхность, чего достаточно
    % при использовании метода Ньютона для пересечения и поиска точек релаксированной границы.

    % Ускоренная версия выполняется после каждой итерации, полноценная -- right before sparsification.

\subsection{Laplacian Regularization}

    % Регуляризация используется на поздних этапах оптимизации для сглаживания поверхности,
    % а также для сравнения с базовым методом. Представляет собой свёртку дистанций SBS with
    % discrete Laplacian kernel. Реализована на CPU, распараллелена по кирпичам, для которых
    % хранится информация о соседях. Применяется только к брикам с поверхностью.

\subsection{Sparsification}

    % Sparsification step выполняется перед upsampling, во время него сохраняются все
    % брики, содержащие поверхность, а также все брики в радиусе 1 от них, включая
    % диагональные. Если какой-либо
    % из соседних бриков отсутствует, то он добавляется здесь. Этот шаг необходим в случае,
    % когда восстанавливаемый объект содержит детали настолько мелкие, что после upsampling
    % брики, в которых должна находиться их реконструкция, отсутствуют. Таким образом,
    % данный шаг не только отвечает за уменьшение размера модели, но и устраняет
    % потенциальное ограничение в сравнении с базовым методом.

\subsection{Upsampling}

    % Upsampling step увеличивает разрешение оставшихся бриков в два раза, получая из
    % одного брика восемь. Новые дистанции рассчитываются с помощью трилинейной
    % интерполяции.


\section{Experiments}

    % Метод реализован с использованием C++ and Vulkan. Эксперименты с базовым методом
    % проводились с использованием [ссылка], где представлена его официальная реализация.
    % Для базового метода использовались гиперпараметры, указанные в статье (ссылка),
    % остальные параметры взяты из конфигурационного файла
    % "turbo.json", изменению подверглись число ракурсов, размер батча и шаги, на которых
    % проводился upsampling. Для
    % сходства экспериментов была использована одинаковая конфигурация источников света:
    % два направленных источника с направлениями (1,1,1) и (-1,-1,-1) и ambient light. 
    % По этой же причине для эталонной реализации были оставлены только первичные лучи
    % и реконструкция только геометрии.
    
    % Эксперименты проводились на 6 моделях, реконструкция велась с 16 ракурсов, получаемых
    % алгоритмом из (ссылка) равномерно по сфере вокруг сцены, размер
    % батча: 4 ракурса. Размеры изображений: 512x512. Начальное приближение -- dense grid
    % with a sphere, размер 32x32x32 voxels. Полный процеcc оптимизации занимает
    % 1000 шагов, upsampling применяется на шагах 200,400,600,700,800,900.
    % Hardware configuration: вычисления производились on AMD Ryzen 9 7950X CPU and
    % Nvidia GeForce RTX 4090.

    % На рис. N показано среднее по всем моделям время реконструкции for each stage between upsampling
    % steps для базового и предлагаемого метода. Они обозначены размером SDF grid в вокселях соответствующего уровня
    % детализации. Batch rendering is a consecutive отрисовка всех ракурсов на текущем
    % батче.

\section{Conclusion} % Должен быть побольше

    % В данной работе был представлен метод дифференцируемого рендеринга разреженного
    % SDF представления. Используя работу (ссылка) as baseline, мы используем преимущества
    % SBS и модифицируем все этапы алгоритма. В результате получем скорость и качество,
    % сравнимое с оригиналом, при этом на порядок снижая потребление памяти.

    % Дальнейшая работа будет направлена на интеграцию метода в path tracer pipeline,
    % исследование способов of bias reduction, а также на упрощение практического применения.
     

\subsection{Order of Sections}

Sections should be arranged in the following order \cite{bgf:Lixto}:
\begin{enumerate}
    \item Main content sections (numbered)
    \item Appendices (optional, numbered using capital letters)
    \item Ethical statement (optional, unnumbered)
    \item Acknowledgements (optional, unnumbered)
    \item Contribution statement (optional, unnumbered)
    \item References (required, unnumbered)
\end{enumerate}


%% The file named.bst is a bibliography style file for BibTeX 0.99c
\bibliographystyle{named}
\bibliography{sparsedr}

\end{document}

